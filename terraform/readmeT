    # Generated by Terraform.
---
#Установка mysql на slave
- hosts: slave_db
  gather_facts: false
  roles:
    - { role: install_mysql,
              mysql_repl_role: slavedb }
#Установка mysql на master
- hosts: master_db
  gather_facts: false
  roles:
    - { role: install_mysql,
              mysql_repl_role: master }
#Конфигурация mysql myster
- hosts: master_db
  gather_facts: false
  roles:
    - { role: ms,
              mysql_repl_role: master }
  vars:
    mysql_root_password: "P@$$w0rd1"
#Конфигурация mysql slave
- hosts: slave_db
  gather_facts: false
  roles:
    - { role: ms,
              mysql_repl_role: slavedb,
              mysql_repl_master: 192.168.26.90  }
# Установка DC
- hosts: ds
  gather_facts: false
  roles:
    - ds
# Установка CS
- hosts: cs
  gather_facts: false
  roles:
    - cs
#Настройка DS для подключении к CS
- hosts: ds
  gather_facts: false
  roles:
    - { role: config_cs_ds,
        mysql_repl_role: ds,
        cs: 192.168.26.243 ,
        ds: 192.168.26.235 }

#Настройка CS для подключении к DS
- hosts: cs
  gather_facts: false
  roles:
    - { role: config_cs_ds,
        mysql_repl_role: cs,
        cs: 192.168.26.243 ,
        ds: 192.168.26.235 }
#настройка CS для подключении к Master
- hosts: cs
  gather_facts: false
  roles:
    - { role: config_cs_mysql,
          mysql: 192.168.26.90   }

